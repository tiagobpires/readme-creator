{% extends "layout.html" %}

{% block title %}
    Profile
{% endblock %}

{% block main %}

    <h1 class="mb-3">Profile Readme</h1>
    <p class="lead fs-4" id="hello">
        Fill in the informations you want to put on your readme
    </p>

    <form method="POST" action="/submit" autocomplete="off">
        <fieldset class="border p-2 mb-2 row gx-2">
            <legend class="legend w-auto mb-0">Greet</legend>
            <div class="col-md-3 mb-2">
                <input type="text" class="form-control" name="title" value="üëã Hello World, I'm">
            </div>

            <div class="col-md-9 mb-2">
                <input type="text" class="form-control" name="name" placeholder="Your name">
            </div>
            
            <div class="">
                <label for="subtitlegreet" class="form-label mt-1">Subtitle</label>
                <input type="text" class="form-control" name="subtitle" placeholder="A computer science student from Brazil">
            </div>
        </fieldset>

        <fieldset class="border p-2 mb-2 row gx-2">
            <legend class="legend w-auto mb-0">More about you</legend>

            {% for about_you in more_about_you %}
                <div class="col-md-3 mb-2">
                    <input name="more_about_you_key" type="text" class="form-control  border-top-0 border-start-0 border-end-0 about_you_prefix" value="{{ about_you['prefix'] }}">
                </div>

                <div class="col-md-9 mb-2">
                    <input name="more_about_you_value" type="text" class="form-control" placeholder="{{ about_you['place_holder'] }}">
                </div>
            {% endfor %}
        </fieldset>


        <fieldset class="border p-2 mb-2 row gx-2">
            <legend class="legend w-auto mb-0">Your Social Medias</legend>
            
            {% for social in social_medias %}
                <div class="d-flex col-md-6 justify-content-start my-1">
                    <div class="divSocialBadges d-flex justify-content-end">
                        <img src="{{ social['link'] }}" class="socialbadges mx-2">
                    </div>
                    <input name="{{ social['name'] }}" type="text" id="{{ social['name'] }}" class="form-control w-50" placeholder="{{ social['name'] }}">
                </div>
            {% endfor %}
        </fieldset>


        <fieldset class="border p-2 mb-2 row gx-2">
            <legend class="legend w-auto mb-0">Cool features</legend>          

            <div class="row">        
                <label for="ghusername" class="col-8 fw-bold px-0 ms-auto">Please fill in your github username for correctly work of the features</label>        
                <input name="github_features_username" type="text" class="form-control col-4 me-auto" id="ghusername" placeholder="GitHub username" style="height: 33px; width: 20%;">
            </div>

            <div class="row align-items-center mx-2">
                <!-- Github Status -->
                <div class="form-check my-1 col-xl-6 align-self-start" id="gh_status_div" onchange="gh_status_preview()">
                    <input name="gh_status_check" class="form-check-input cool_features_check" type="checkbox" value="true" id="ghstatus">
                    <label class="form-check-label" for="ghstatus">
                    GitHub Status
                    </label> 

                    <button type="button" class="btn btn-lightettings pt-0 pb-1 px-1" onclick="displaySettings('gh_status_settings'); gh_status_preview()">‚öôÔ∏è</button>

                    <div id="gh_status_settings" class="bg-success p-3" style="display: none; --bs-bg-opacity: .04;">
                        <div class="form-check my-1">
                            <input name="gh_status_show_icons" class="form-check-input" type="checkbox" value="show" id="show_icons_stats" checked>
                            <label class="form-check-label" for="show_icons_stats">
                            Show icons
                            </label>
                        </div>

                        <div class="form-check my-1">
                            <input name="gh_status_count_private_contribs" class="form-check-input" type="checkbox" value="cont" id="cont_private_contribs" checked>
                            <label class="form-check-label" for="cont_private_contribs">
                            Count commits to privates repositories
                            </label>
                        </div>

                        <div class="form-check my-1 ps-0">
                            <label>Themes:</label>
                            <select name="gh_status_theme" class="form-select py-1 ps-2 features_settings_input" id="gh_status_theme">
                                <option value="default" selected>Default</option>
                                {% for theme in themes %}
                                    <option value="{{ theme }}">{{ theme|title }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <p class="m-1">Hide individual stats:</p>
                        <div class="form-check form-check-inline" id="hide_individual_stats">
                            <input name="gh_status_hide" class="form-check-input gh_status_hide" type="checkbox" id="stars" value="stars">
                            <label class="form-check-label" for="stars">stars</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input name="gh_status_hide" class="form-check-input gh_status_hide" type="checkbox" id="commits" value="commits">
                            <label class="form-check-label" for="commits">commits</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input name="gh_status_hide" class="form-check-input gh_status_hide" type="checkbox" id="prs" value="prs">
                            <label class="form-check-label" for="prs">prs</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input name="gh_status_hide" class="form-check-input gh_status_hide" type="checkbox" id="issues" value="issues">
                            <label class="form-check-label" for="issues">issues</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input name="gh_status_hide" class="form-check-input gh_status_hide" type="checkbox" id="contribs" value="contribs">
                            <label class="form-check-label" for="contribs">contribs</label>
                        </div>

                        <div id="gh_status_preview" class="d-flex justify-content-center mt-2">
                            <img src="" alt="github status" class="features_preview">
                        </div>
                    </div>
                </div>

                <!-- Top Languages Card -->
                <div class="form-check my-1 col-xl-6 align-self-start" id="gh_top_languages_div" onchange="top_languages_preview()">
                    <input name="gh_top_languages_check" class="form-check-input cool_features_check" type="checkbox" value="true" id="gh_top_languages">
                    <label class="form-check-label" for="gh_top_languages">
                        Top Languages Card
                    </label>

                    <button type="button" class="btn btn-lightettings pt-0 pb-1 px-1" onclick="displaySettings('gh_top_languages_settings');top_languages_preview();">‚öôÔ∏è</button>

                    <div id="gh_top_languages_settings" class="bg-success p-3" style="display: none; --bs-bg-opacity: .04;">
                        <div class="form-check my-1">
                            <input name="top_langs_layout" class="form-check-input" type="checkbox" value="compact" id="tl_layout" checked>
                            <label class="form-check-label" for="tl_layout">
                                Compact Layout
                            </label>
                        </div>

                        <div class="form-check my-1 ps-0">
                            <label>Themes:</label>
                            <select name="top_langs_theme" class="form-select py-1 ps-2 features_settings_input" id="top_langs_theme">
                                <option value="default" selected>Default</option>
                                {% for theme in themes %}
                                    <option value="{{ theme }}">{{ theme|title }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="form-check my-1 ps-0">
                            <label>Number of Languages showed:</label>
                            <select name="top_langs_count" class="form-select py-1 ps-2 features_settings_input" id="top_langs_count">
                                {% for n in range(1,11) %}
                                    {% if n == 5 %}
                                        <option value="5" selected>5</option>
                                    {% else %}
                                        <option value="{{ n }}">{{ n }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                        <div id="top_languages_preview" class="d-flex justify-content-center mt-2">
                            <img src="" alt="top languages" class="features_preview">
                        </div>
                    </div>
                </div>
            </div>

            <div class="row align-items-center mx-2">
                <!-- Profile Views -->
                <div class="form-check my-1 col-xl-6 align-self-start" id="profile_views_div" onchange="profile_views_preview()">
                    <input name="gh_views_check" class="form-check-input cool_features_check" type="checkbox" value="true" id="ghviews">
                    <label class="form-check-label" for="ghviews">
                    Profile Views
                    </label>

                    <button type="button" class="btn btn-lightettings pt-0 pb-1 px-1" onclick="displaySettings('gh_views_settings');profile_views_preview();">‚öôÔ∏è</button>
                    <div id="gh_views_settings" class="bg-success p-3" style="display: none; --bs-bg-opacity: .04;">
                        <div class="mb-1 ps-0">
                            <label>Color:</label>
                            <select name="gh_views_color" class="form-select py-1 ps-2 features_settings_input" id="gh_views_color">
                                <option value="blue" selected>Blue</option>
                                <option value="ff69b4">Pink</option>
                                {% for color in colors %}
                                    <option value="{{ color }}">{{ color|title }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="my-1 ps-0">
                            <label>Styles:</label>
                            <select name="gh_views_style" class="form-select py-1 ps-2 features_settings_input" id="gh_views_style">
                                <option value="flat" selected>Flat</option>
                                <option value="flat-square">Flat-square</option>
                                <option value="plastic">Plastic</option>
                            </select>
                        </div>
                        
                        <label for="gh_views_label">Label</label>
                        <input name="gh_views_label" type="text" class="form-control py-1 ps-2 features_settings_input" value="Profile Views" id="gh_views_label">
                        
                        <div id="profile_views_preview" class="d-flex justify-content-center mt-2">
                            <img src="" alt="profile views" class="features_preview">
                        </div>
                    </div>
                </div>

                <!-- Streak Stats -->
                <div class="form-check my-1 col-xl-6 align-self-start" id="streak_stats_div" onchange="streak_stats_preview()">
                    <input name="gh_streak_stats_check" class="form-check-input cool_features_check" type="checkbox" value="true" id="gh_streak">
                    <label class="form-check-label" for="gh_streak">
                    Streak Stats
                    </label>

                    <button type="button" class="btn btn-lightettings pt-0 pb-1 px-1" onclick="displaySettings('streak_stats_settings');streak_stats_preview();">‚öôÔ∏è</button>

                    <div id="streak_stats_settings" class="bg-success p-3" style="display: none; --bs-bg-opacity: .04;">
                        <label>Themes:</label>
                        <select name="streak_stats_theme" class="form-select py-1 ps-2 features_settings_input" id="streak_stats_theme">
                            <option value="default" selected>Default</option>
                            {% for theme in themes %}
                                <option value="{{ theme }}">{{ theme|title }}</option>
                            {% endfor %}
                        </select>

                        <div id="streak_stats_preview" class="d-flex justify-content-center mt-2">
                            <img src="" alt="streak stats" class="features_preview">
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>

        <fieldset class="border p-2 mb-2 row gx-2 d-flex justify-content-center">
            <legend class="legend w-auto mb-0">Your Skills</legend>
            <div id="skillsdiv" class="row">
                {% for skill in skills %}
                    <div class="form-check my-4 col-6 col-md-4 col-xl-3 d-flex justify-content-center">
                        <input name="skill_name" class="form-check-input" type="checkbox" value="{{ skill['name'] }}">
                        <input name="{{ skill['name'] }}" class="visually-hidden" value="{{ skill['link'] }}">
                        <img src="{{ skill['link'] }}" class="skillsImage ms-4">
                    </div>
                {% endfor %}
            </div>
        </fieldset>
        
        <input type="submit">
    </form>

{% endblock %}

{% block script %}
<script>
    // Hide or set display of div Cool Features Settings
    function displaySettings(id) {
        let div = document.getElementById(id);
        if (div.style.display === "none") {
            div.style.display = "block";
        } else {                          
            div.style.display = "none";
        }
    }

    social_github = document.getElementById("github username")
    social_github.addEventListener("keyup", function() {
        document.getElementById("ghusername").value = social_github.value;
    });


    // Preview for Github Status Feature
    function gh_status_preview(){
        let imageUrl = "https://github-readme-stats.vercel.app/api?username=" + document.getElementById("ghusername").value;

        imageUrl += "&theme=" + document.getElementById("gh_status_theme").value;
        
        imageUrl += "&show_icons=" + document.getElementById("show_icons_stats").checked;

        imageUrl += "&count_private=" + document.getElementById("cont_private_contribs").checked;
        
        hide_stats = document.querySelectorAll(".gh_status_hide:checked");
        if (hide_stats.length > 0) {
            imageUrl += '&hide=' + hide_stats[0].value;
            for (let i = 1; i < hide_stats.length; i++) {
                imageUrl += ',' + hide_stats[i].value;
            }
        }

        document.getElementById("gh_status_preview").innerHTML = '<img src="' + imageUrl + '" class="features_preview" >';
    }


    // Preview for Top Languages Feature
    function top_languages_preview(){

    let imageUrl = "https://github-readme-stats.vercel.app/api/top-langs/?username=" + document.getElementById("ghusername").value;
    imageUrl += "&theme=" + document.getElementById("top_langs_theme").value;

    if (document.getElementById("tl_layout").checked) {
        imageUrl += "&layout=compact";
    }

    imageUrl += "&langs_count=" +  document.getElementById("top_langs_count").value;

    document.getElementById("top_languages_preview").innerHTML = '<img src="' + imageUrl + '" class="features_preview">';
    }

    // Preview for Profile Views Feature
    function profile_views_preview(){
        let imageUrl = "https://komarev.com/ghpvc/?username=" + document.getElementById("ghusername").value;
        imageUrl += "&theme=" + document.getElementById("top_langs_theme").value;

        imageUrl += "&color=" +  document.getElementById("gh_views_color").value;

        imageUrl += "&style=" +  document.getElementById("gh_views_style").value;

        label = String(document.getElementById("gh_views_label").value);
        label = label.replace(' ', '+');
        imageUrl += "&label=" + label;

        document.getElementById("profile_views_preview").innerHTML = '<img src="' + imageUrl + '" class="features_preview">';
    }

    // Preview for Streak Stats Feature
    function streak_stats_preview(){
        let imageUrl = "https://github-readme-streak-stats.herokuapp.com/?user=" + document.getElementById("ghusername").value;
        
        imageUrl += "&theme=" + document.getElementById("streak_stats_theme").value;

        document.getElementById("streak_stats_preview").innerHTML = '<img src="' + imageUrl + '" class="features_preview" >';
    }

</script>
{% endblock %}